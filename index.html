<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <title>Prueba Firebase Hosting + Storage</title>
    <!-- SDKs de Firebase (compatibles con HTML directo) -->
    <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-storage-compat.js"></script>
    <style>
      body {
        font-family: sans-serif;
        padding: 20px;
      }
      button {
        margin: 5px;
        padding: 8px 12px;
        font-size: 14px;
      }
      #userInfo {
        margin-top: 10px;
        font-weight: bold;
      }
    </style>
  </head>
  <body>
    <h1>üî• Prueba Firebase Hosting + Storage</h1>

    <button onclick="login()">Iniciar sesi√≥n con Google</button>
    <button onclick="logout()">Cerrar sesi√≥n</button><br><br>

    <input type="file" id="fileInput">
    <button onclick="uploadFile()">Subir archivo</button>

    <p id="userInfo">No has iniciado sesi√≥n.</p>

    <script>
      // Configuraci√≥n de tu proyecto Firebase
      const firebaseConfig = {
        apiKey: "AIzaSyDmGboo0Apcx9oJSrjlFfDYtDs3BjTJYsQ",
        authDomain: "faltaunov2.firebaseapp.com",
        projectId: "faltaunov2",
        storageBucket: "faltaunov2.appspot.com",
        messagingSenderId: "906428933845",
        appId: "1:906428933845:web:4d8622c58f6ae26fe1a45c"
      };

      // Inicializaci√≥n de Firebase
      firebase.initializeApp(firebaseConfig);
      const auth = firebase.auth();
      const storage = firebase.storage();

      // Funci√≥n de login con Google
      function login() {
        const provider = new firebase.auth.GoogleAuthProvider();
        auth.signInWithPopup(provider)
          .then(result => {
            const user = result.user;
            document.getElementById("userInfo").innerText = `üëã Hola, ${user.displayName} (${user.email})`;
          })
          .catch(error => {
            console.error("Error al iniciar sesi√≥n:", error);
            alert("Error en login: " + error.message);
          });
      }

      // Funci√≥n de logout
      function logout() {
        auth.signOut()
          .then(() => {
            document.getElementById("userInfo").innerText = "Sesi√≥n cerrada";
            alert("Saliste correctamente.");
          });
      }

      // Listener para detectar si el usuario ya est√° logueado
      auth.onAuthStateChanged(user => {
        if (user) {
          document.getElementById("userInfo").innerText = `üëã Hola, ${user.displayName} (${user.email})`;
        } else {
          document.getElementById("userInfo").innerText = "No has iniciado sesi√≥n.";
        }
      });

      // Funci√≥n para subir archivo
      function uploadFile() {
        const user = auth.currentUser;
        if (!user) return alert("Primero inici√° sesi√≥n");

        const file = document.getElementById("fileInput").files[0];
        if (!file) return alert("Seleccion√° un archivo");

        const ref = storage.ref(`archivos/${user.uid}/${file.name}`);
        ref.put(file)
          .then(() => {
            alert("‚úÖ Archivo subido con √©xito");
          })
          .catch(error => {
            console.error("Error al subir:", error);
            alert("‚ùå Error al subir archivo: " + error.message);
          });
      }
    </script>
  </body>
</html>
